<div class="profile">
  <div class="profile__title">
    <h2>Profile Settings</h2>
  </div>

  <form [formGroup]="profileForm" class="profile__form" (ngSubmit)="onSubmit()">
    @if (serverError) {
      <div class="server-side-error">
        {{ serverError }}
      </div>
    }

    <div class="profile__form__input">
      <app-input
        [placeholder]="'First name'"
        [label]="'First name'"
        [errorState]="!!serverError || !!(profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched)"
        formControlName="firstName"
      ></app-input>

      @if (profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched) {
        <div class="error">
          Please use Latin letters only.
        </div>
      }
    </div>

    <div class="profile__form__input">
      <app-input
        [placeholder]="'Last name'"
        [label]="'Last name'"
        [errorState]="!!serverError || !!(profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched)"
        formControlName="lastName"
      ></app-input>

      @if (profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched) {
        <div class="error">
          Please use Latin letters only.
        </div>
      }
    </div>

    <div class="profile__form__input">
      <app-input
        [placeholder]="'Username'"
        [label]="'Username'"
        [errorState]="!!serverError || !!(profileForm.get('username')?.invalid && profileForm.get('username')?.touched)"
        formControlName="username"
      ></app-input>

      @if (profileForm.get('username')?.invalid && profileForm.get('username')?.touched) {
        <div class="error">
          Please enter the username.
        </div>
      }
    </div>

    <div class="profile__form__input">
      <app-input
        [placeholder]="'Email'"
        [type]="'email'"
        [label]="'Email'"
        [errorState]="!!serverError || !!(profileForm.get('email')?.invalid && profileForm.get('email')?.touched)"
        formControlName="email"
      ></app-input>

      @if (profileForm.get('email')?.invalid && profileForm.get('email')?.touched) {
        <div class="error">
          Please enter a valid email.
        </div>
      }
    </div>

    <div class="profile__form__input">
      <app-input
        [placeholder]="'Phone number'"
        [label]="'Phone number'"
        [errorState]="!!serverError || !!(profileForm.get('phoneNumber')?.invalid && profileForm.get('phoneNumber')?.touched)"
        formControlName="phoneNumber"
      ></app-input>

      @if (profileForm.get('phoneNumber')?.invalid && profileForm.get('phoneNumber')?.touched) {
        <div class="error">
          Please enter the phone number.
        </div>
      }
    </div>

    <app-checkbox [label]="'I agree to receive promotions'" [formControlName]="'newsletterConsent'"></app-checkbox>

    <div class="profile__form__buttons flex gap-48">
      <app-button
        class="profile__form__buttons__button"
        [size]="'s'"
        [disabled]="!profileForm.valid"
      >
        Save Changes
      </app-button>

      <app-button variant="secondary"
        class="profile__form__buttons__button"
        [size]="'s'"
        (click)="logout()"
      >
        Logout
      </app-button>
    </div>
  </form>
</div>
